@using Color = MudBlazor.Color
@using Image = SixLabors.ImageSharp.Image
@using Size = MudBlazor.Size
@using Radiate.Schema
@using Radiate.Client.Components.Store.States.Features
@using Radiate.Client.Components.Store.Selections
@* @inherits StateComponent<EngineControl, RunState> *@
@inherits StoreComponent<RunModel>

@if (Model.IsRunning)
{
    <MudButton Class="w-100"
               Size="Size.Small"
               Variant="Variant.Filled"
               Color="Color.Secondary"
               OnClick="@Stop">
        Stop
    </MudButton>
}
else
{
	<MudButton Size="Size.Small"
	           Color="Color.Tertiary" 
	           Variant="Variant.Filled"
	           Class="float-right" 
	           OnClick="@Start">
		<MudIcon Icon="@Icons.Material.Filled.PlayArrow" 
		         Class="ml-0 mr-2" 
		         Size="Size.Small"/>
        Run
    </MudButton>
}

@code {
    
    private void Start() => Store.Dispatch(new StartEngineAction(Model.RunId, Model.Inputs));

    private void Stop() => Store.Dispatch(new CancelEngineRunAction(Model.RunId));
    
    protected override IObservable<RunModel> Select() => Store.Select(RunSelectors.SelectCurrentRun);
}