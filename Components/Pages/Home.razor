@page "/"
@rendermode InteractiveServer
@inject NavigationManager NavigationManager
@using Radiate.Client.Domain.Store
@using Radiate.Client.Domain.Store.Actions
@using Radiate.Client.Domain.Store.Models.States
@inherits StoreComponent<RootState>

<MudTable OnRowClick="@((TableRowClickEventArgs<RunState> args) => OnSelect(args))" Items="@Model?.Runs.Values.ToList()" Class="mx-4 px-8">
    <HeaderContent>
        <MudTh></MudTh>
        <MudTh>Model</MudTh>
        <MudTh>Data Set</MudTh>
    </HeaderContent>
    <RowTemplate>
        <MudTd>@context.Index</MudTd>
        <MudTd DataLabel="Model">@context.Inputs.ModelType</MudTd>
        <MudTd DataLabel="Data Set">@context.Inputs.DataSetType</MudTd>
    </RowTemplate>
</MudTable>

@code
{
    protected override IObservable<RootState> Select() => Store.Select(state => state);

    private void OnSelect(TableRowClickEventArgs<RunState> run)
    {
        Dispatch(new NavigateToRunAction(run.Item.RunId));
        NavigationManager.NavigateTo($"/runs/{run.Item.RunId}/{run.Item.Inputs.ModelType.ToLower()}");
    }
}
