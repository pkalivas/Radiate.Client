@using Radiate.Client.Services.Store.Models.Projections
@inherits StoreComponent<MetricDataGridPanelProjection>

<MudDataGrid Dense="true"
             Elevation="0"
             Items="@Model.Values"
             FixedHeader="true"
             Virtualize="true">
    <Columns>
        <PropertyColumn StickyLeft="true" Sortable="true" Property="x => FormatName(x.Name)" Title="Name" Hideable="false" Filterable="true"/>
        <PropertyColumn Property="x => x.Value" Title="Value" Hideable="true"/>
        <PropertyColumn Property="x => x.Min" Title="Min" Hideable="true" Groupable="true" Filterable="true"/>
        <PropertyColumn Property="x => x.Max" Title="Max" Hideable="true" Groupable="true" Filterable="true"/>
        <PropertyColumn Property="x => x.Mean" Title="Avg." Hideable="true" Groupable="true" Filterable="true"/>
        <PropertyColumn Property="x => x.Variance" Title="Var." Hidden="true" Hideable="true" Groupable="true" Filterable="true"/>
        <PropertyColumn Property="x => x.Kurtosis" Title="Kurt." Hidden="true" Hideable="true" Groupable="true" Filterable="true"/>
        <PropertyColumn Property="x => x.Skewness" Title="Skew." Hidden="true" Hideable="true" Groupable="true" Filterable="true"/>
        <PropertyColumn Property="x => FormatDuration(x.MeanTime)" Title="Avg. Duration" Hideable="true" Groupable="true" Filterable="true"/>
        <PropertyColumn Property="x => FormatDuration(x.Total)" Title="Duration" Hideable="true" Groupable="true" Filterable="true"/>
    </Columns>
</MudDataGrid>

@code {

    protected override IObservable<MetricDataGridPanelProjection> Select() =>
        Store.Select(RunSelectors.SelectMetricDataGridPanelModel);

    private string FormatDuration(TimeSpan duration) => duration.ToString("mm\\:ss\\:ffff");

    private string FormatName(string name) => name.Split("`")[0];
}